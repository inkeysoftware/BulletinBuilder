<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta charset="UTF-8">
      <title>Vimod-Pub App</title>
      <link rel="stylesheet" href="file:///C:/AsiaBulletin-SVN/trunk/tools/electron/css/electron.css">
   </head>
   <body>
      <h1>Utilities Project</h1>
      <h3>project.menu</h3>
      <ul class="table-view">
         <li class="table-view-cell"><a href="../index.html">â‡ª</a></li><button type="button" id="executeBat1" style="width:60%">Update Vimod-Pub App                    </button><br><script>
    document.getElementById("executeBat1").addEventListener("click",function(e){
        var myBatFilePath = "D:\\All-SIL-Publishing\\github-SILAsiaPub\\vimod-pub\\trunk\\pub.cmd tasklist C:\\AsiaBulletin-SVN\\trunk\\data\\Utilities electron-make-pages.tasks";
        const spawn = require('child_process').spawn;
        const bat = spawn('cmd.exe', ['/c', myBatFilePath]);
        bat.stdout.on('data', (data) => {
            var str = String.fromCharCode.apply(null, data);
            addLog(data);
            console.info(str);
        });
        bat.stderr.on('data', (data) => {
            var str = String.fromCharCode.apply(null, data);
            addLog(data,"error");
            console.error(str);
        });
        bat.on('exit', (code) => {
            console.log(`Child exited with code ${code}`);
            var preText = `Child exited with code ${code} : `;
            switch(code){
                case 0:
                    addLog(preText+"All good","final");
                    break;
                case 1:
                    addLog(preText+"An error ocurred while running tasks","final");
                    break;
            }
        });
    },false);
</script></ul>
      <hr><button type="button" onclick="resetLog()" style="width:60%">Clear log</button><br><ul id="log-container"></ul><script>'use strict';
    function resetLog(){
        return document.getElementById("log-container").innerHTML = "";
    }
    function addLog(message,type){
        var el = document.getElementById("log-container");
        var newItem = document.createElement("li");       // Create a li node
        var textnode = document.createTextNode(message);  // Create a text node
        if(type == "error"){
            newItem.style.color = "red";
        }else if(type == "final"){
            newItem.style.color = "blue";
        }
        newItem.appendChild(textnode);                    // Append the text to li
        el.appendChild(newItem);
    }

</script></body>
</html>